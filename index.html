<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="python web">
<meta property="og:type" content="website">
<meta property="og:title" content="陈亚坤的Blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="陈亚坤的Blog">
<meta property="og:description" content="python web">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="陈亚坤的Blog">
<meta name="twitter:description" content="python web">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title> 陈亚坤的Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">陈亚坤的Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">python study</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Accueil
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/23/Mysql-特殊命令/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="陈亚坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈亚坤的Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/23/Mysql-特殊命令/" itemprop="url">
                  Mysql 特殊命令
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-23T23:33:09+08:00">
                2017-08-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-MySQL中删除重复数据只保留一条"><a href="#1-MySQL中删除重复数据只保留一条" class="headerlink" title="1. MySQL中删除重复数据只保留一条"></a>1. MySQL中删除重复数据只保留一条</h2><h3 id="1-1查找表中多余的重复记录，重复记录是根据单个字段（peopleId）来判断"><a href="#1-1查找表中多余的重复记录，重复记录是根据单个字段（peopleId）来判断" class="headerlink" title="1.1查找表中多余的重复记录，重复记录是根据单个字段（peopleId）来判断"></a>1.1查找表中多余的重复记录，重复记录是根据单个字段（peopleId）来判断</h3><pre><code>SELECT * FROM people WHERE peopleId IN (
SELECT peopleId FROM people GROUP BY peopleId HAVING count(peopleId) &gt; 1
)
</code></pre><h3 id="1-2-查看某个字段是否是唯一值"><a href="#1-2-查看某个字段是否是唯一值" class="headerlink" title="1.2 查看某个字段是否是唯一值"></a>1.2 查看某个字段是否是唯一值</h3><pre><code>select x,count(*) from xxx group by x having count(*)&gt;1;
</code></pre><h3 id="1-3-删除表中多余的重复记录，重复记录是根据单个字段（peopleId）来判断，只留有rowid最小的记录"><a href="#1-3-删除表中多余的重复记录，重复记录是根据单个字段（peopleId）来判断，只留有rowid最小的记录" class="headerlink" title="1.3 删除表中多余的重复记录，重复记录是根据单个字段（peopleId）来判断，只留有rowid最小的记录"></a>1.3 删除表中多余的重复记录，重复记录是根据单个字段（peopleId）来判断，只留有rowid最小的记录</h3><pre><code>DELETE FROM people WHERE peopleName IN (
SELECT peopleName FROM people GROUP BY peopleName HAVINGcount(peopleName) &gt; 1
)
AND peopleId NOT IN (SELECT min(peopleId) FROM people GROUP BY peopleName HAVING count(peopleName) &gt; 1
)
</code></pre><h3 id="1-4-查找表中多余的重复记录（多个字段）"><a href="#1-4-查找表中多余的重复记录（多个字段）" class="headerlink" title="1.4 查找表中多余的重复记录（多个字段）"></a>1.4 查找表中多余的重复记录（多个字段）</h3><pre><code>SELECT  * FROM  vitae a WHERE
(a.peopleId, a.seq) IN ( SELECT  peopleId, seq FROM vitae GROUP BY
peopleId, seq HAVING count(*) &gt; 1)
</code></pre><h3 id="作者：陈亚坤"><a href="#作者：陈亚坤" class="headerlink" title="作者：陈亚坤"></a><strong>作者：陈亚坤</strong></h3><h3 id="邮箱：cykstart-163-com"><a href="#邮箱：cykstart-163-com" class="headerlink" title="邮箱：cykstart@163.com"></a><strong>邮箱：cykstart@163.com</strong></h3><h3 id="版权声明"><a href="#版权声明" class="headerlink" title="版权声明:"></a><strong>版权声明:</strong></h3><p>本篇博客仅作为参考学习资料，版权所有，侵权必删，请联系！部分代码取自互联网公开资料。版权归其所写个人/公司所有！</p>
<h3 id="参考资料链接"><a href="#参考资料链接" class="headerlink" title="参考资料链接:"></a><strong>参考资料链接:</strong></h3><p><a href="http://blog.csdn.net/u014723529/article/details/51218638" target="_blank" rel="external">http://blog.csdn.net/u014723529/article/details/51218638</a><br><a href="http://www.jb51.net/article/23964.htm" target="_blank" rel="external">http://www.jb51.net/article/23964.htm</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/23/Mysql-常见操作-索引操作/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="陈亚坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈亚坤的Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/23/Mysql-常见操作-索引操作/" itemprop="url">
                  Mysql 常见操作-索引操作
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-23T23:18:02+08:00">
                2017-08-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-添加索引"><a href="#1-添加索引" class="headerlink" title="1.添加索引"></a>1.添加索引</h2><h3 id="1-1添加PRIMARY-KEY-主键索引"><a href="#1-1添加PRIMARY-KEY-主键索引" class="headerlink" title="1.1添加PRIMARY KEY(主键索引)"></a>1.1添加PRIMARY KEY(主键索引)</h3><pre><code>mysql&gt;alter table &apos;table_name&apos; add primary key (&apos;column&apos;);#字段名
</code></pre><h3 id="1-2添加UNIQUE-唯一索引"><a href="#1-2添加UNIQUE-唯一索引" class="headerlink" title="1.2添加UNIQUE(唯一索引)"></a>1.2添加UNIQUE(唯一索引)</h3><pre><code>mysql&gt;ALTER TABLE `table_name` ADD UNIQUE (`column`);
</code></pre><h3 id="1-3添加INDEX-普通索引"><a href="#1-3添加INDEX-普通索引" class="headerlink" title="1.3添加INDEX(普通索引)"></a>1.3添加INDEX(普通索引)</h3><pre><code>mysql&gt;ALTER TABLE `table_name` ADD INDEX index_name (`column`);#索引名 
</code></pre><h3 id="1-4添加FULLTEXT-全文索引"><a href="#1-4添加FULLTEXT-全文索引" class="headerlink" title="1.4添加FULLTEXT(全文索引)"></a>1.4添加FULLTEXT(全文索引)</h3><pre><code>mysql&gt;ALTER TABLE `table_name` ADD FULLTEXT (`column`);
</code></pre><h3 id="1-5添加多列索引"><a href="#1-5添加多列索引" class="headerlink" title="1.5添加多列索引"></a>1.5添加多列索引</h3><pre><code>mysql&gt;ALTER TABLE `table_name` ADD INDEX index_name (`column1`,`column2`, `column3`)
</code></pre><h2 id="2-删除索引"><a href="#2-删除索引" class="headerlink" title="2.删除索引"></a>2.删除索引</h2><pre><code>DROP INDEX index_name ON talbe_name;#等同于第二句
ALTER TABLE table_name DROP INDEX index_name;#等同于第一句
ALTER TABLE table_name DROP PRIMARY KEY;#只适合删除主键
</code></pre><h2 id="3-查看索引"><a href="#3-查看索引" class="headerlink" title="3.查看索引"></a>3.查看索引</h2><pre><code>mysql&gt; show index from tblname;
mysql&gt; show keys from tblname;
</code></pre><h3 id="作者：陈亚坤"><a href="#作者：陈亚坤" class="headerlink" title="作者：陈亚坤"></a><strong>作者：陈亚坤</strong></h3><h3 id="邮箱：cykstart-163-com"><a href="#邮箱：cykstart-163-com" class="headerlink" title="邮箱：cykstart@163.com"></a><strong>邮箱：cykstart@163.com</strong></h3><h3 id="版权声明"><a href="#版权声明" class="headerlink" title="版权声明:"></a><strong>版权声明:</strong></h3><p>本篇博客仅作为参考学习资料，版权所有，侵权必删，请联系！部分代码取自互联网公开资料。版权归其所写个人/公司所有！</p>
<h3 id="参考资料链接"><a href="#参考资料链接" class="headerlink" title="参考资料链接:"></a><strong>参考资料链接:</strong></h3><p><a href="http://www.cnblogs.com/zz-tt/p/6609828.html" target="_blank" rel="external">http://www.cnblogs.com/zz-tt/p/6609828.html</a><br><a href="http://www.jb51.net/article/32149.htm" target="_blank" rel="external">http://www.jb51.net/article/32149.htm</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/01/友情链接/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="陈亚坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈亚坤的Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/01/友情链接/" itemprop="url">
                  友情链接
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-01T14:47:42+08:00">
                2017-08-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/01/Redis命令大全/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="陈亚坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈亚坤的Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/01/Redis命令大全/" itemprop="url">
                  Redis命令大全
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-01T14:46:49+08:00">
                2017-08-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/01/Mysql命令大全/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="陈亚坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈亚坤的Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/01/Mysql命令大全/" itemprop="url">
                  Mysql命令大全
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-01T11:50:44+08:00">
                2017-08-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>###1.连接mysql</p>
<h4 id="1-1连接到本机的mysql"><a href="#1-1连接到本机的mysql" class="headerlink" title="1.1连接到本机的mysql"></a>1.1连接到本机的mysql</h4><p><strong>首先打开DOS窗口，然后进入目录mysql\bin，再键入命令mysql -u root -p，回车后提示你输密码.注意用户名前可以有空格也可以没有空格，但是密码前必须没有空格，否则让你重新输入密码。<br>如果刚安装好MYSQL，超级用户root是没有密码的，故直接回车即可进入到MYSQL中了，MYSQL的提示符是： mysql&gt;</strong></p>
<h4 id="1-2连接远程的mysql"><a href="#1-2连接远程的mysql" class="headerlink" title="1.2连接远程的mysql"></a>1.2连接远程的mysql</h4><p><strong>假设远程主机的IP为：110.110.110.110，用户名为root,密码为abcd123。则键入以下命令：</strong></p>
<pre><code>mysql -h110.110.110.110 -u root -p 123;
</code></pre><p><strong>（注:u与root之间可以不用加空格，其它也一样）</strong></p>
<h4 id="1-3退出mysql"><a href="#1-3退出mysql" class="headerlink" title="1.3退出mysql"></a>1.3退出mysql</h4><p><strong>exit （回车）</strong></p>
<h3 id="2-修改密码"><a href="#2-修改密码" class="headerlink" title="2.修改密码"></a>2.修改密码</h3><p>格式：mysqladmin -u用户名 -p旧密码 password 新密码</p>
<p>####2.1给root加个密码ab12。<br><strong>首先在DOS下进入目录mysql\bin，然后键入以下命令</strong>  </p>
<pre><code>mysqladmin -u root -password ab12  
</code></pre><p><strong>注：因为开始时root没有密码，所以-p旧密码一项就可以省略了。</strong></p>
<p>####2.2再将root的密码改为djg345。<br>    mysqladmin -u root -p ab12 password djg345</p>
<h3 id="3-增加用户"><a href="#3-增加用户" class="headerlink" title="3.增加用户"></a>3.增加用户</h3><p>格式：grant select on 数据库.* to 用户名@登录主机 identified by “密码”;</p>
<p>####3.1 增加一个用户test1密码为abc，让他可以在任何主机上登录，并对所有数据库有查询、插入、修改、删除的权限。首先用root用户连入MYSQL，然后键入以下命令：</p>
<pre><code>grant select,insert,update,delete on *.* to [email=test1@”%]test1@”%[/email]” Identified by “abc”;
</code></pre><blockquote>
<p><strong>但增加的用户是十分危险的，你想如某个人知道test1的密码，那么他就可以在internet上的任何一台电脑上登录你的mysql数据库并对你的数据可以为所欲为了，解决办法见2</strong></p>
</blockquote>
<p>####3.2 增加一个用户test2密码为abc,让他只可以在localhost上登录，并可以对数据库mydb进行查询、插入、修改、删除的操作<br><strong>（localhost指本地主机，即MYSQL数据库所在的那台主机），这样用户即使用知道test2的密码，他也无法从internet上直接访问数据库，只能通过MYSQL主机上的web页来访问了。</strong></p>
<pre><code>grant select,insert,update,delete on mydb.* to [email=test2@localhost]test2@localhost[/email] identified by “abc”;
</code></pre><p>如果你不想test2有密码，可以再打一个命令将密码消掉。<br>    grant select,insert,update,delete on mydb.* to [email=test2@localhost]test2@localhost[/email] identified by “”;</p>
<h3 id="4-1-创建数据库"><a href="#4-1-创建数据库" class="headerlink" title="4.1 创建数据库"></a>4.1 创建数据库</h3><p>注意：创建数据库之前要先连接Mysql服务器<br>命令：create database &lt;数据库名&gt;  </p>
<pre><code>greate database chenyakun charset=utf8;
</code></pre><h4 id="4-1-1建立一个名为xhkdb的数据库"><a href="#4-1-1建立一个名为xhkdb的数据库" class="headerlink" title="4.1.1建立一个名为xhkdb的数据库"></a>4.1.1建立一个名为xhkdb的数据库</h4><pre><code>mysql&gt; create database xhkdb;
</code></pre><h4 id="4-1-2创建数据库并分配用户"><a href="#4-1-2创建数据库并分配用户" class="headerlink" title="4.1.2创建数据库并分配用户"></a>4.1.2创建数据库并分配用户</h4><pre><code>CREATE DATABASE 数据库名;

GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON 数据库名.* TO 数据库名@localhost IDENTIFIED BY &apos;密码&apos;;

SET PASSWORD FOR &apos;数据库名&apos;@&apos;localhost&apos; = OLD_PASSWORD(&apos;密码&apos;);
</code></pre><p>依次执行3个命令完成数据库创建。注意：中文 “密码”和“数据库”是户自己需要设置的。</p>
<h3 id="4-2-显示数据库"><a href="#4-2-显示数据库" class="headerlink" title="4.2 显示数据库"></a>4.2 显示数据库</h3><p>命令：show databases （注意：最后有个s）</p>
<pre><code>mysql&gt; show databases;
</code></pre><p>注意：为了不再显示的时候乱码，要修改数据库默认编码。以下以GBK编码页面为例进行说明：</p>
<pre><code>修改MYSQL的配置文件：my.ini里面修改default-character-set=gbk
</code></pre><h3 id="4-3-删除数据库"><a href="#4-3-删除数据库" class="headerlink" title="4.3 删除数据库"></a>4.3 删除数据库</h3><h4 id="4-3-1删除一个已经确定存在的数据库"><a href="#4-3-1删除一个已经确定存在的数据库" class="headerlink" title="4.3.1删除一个已经确定存在的数据库"></a>4.3.1删除一个已经确定存在的数据库</h4><pre><code>mysql&gt; drop database drop_database;
Query OK, 0 rows affected (0.00 sec)
</code></pre><h4 id="4-3-2删除一个不确定存在的数据库"><a href="#4-3-2删除一个不确定存在的数据库" class="headerlink" title="4.3.2删除一个不确定存在的数据库"></a>4.3.2删除一个不确定存在的数据库</h4><pre><code>mysql&gt; drop database drop_database;
ERROR 1008 (HY000): Can&apos;t drop database &apos;drop_database&apos;; database doesn&apos;t exist
//发生错误，不能删除&apos;drop_database&apos;数据库，该数据库不存在。
mysql&gt; drop database if exists drop_database;
Query OK, 0 rows affected, 1 warning (0.00 sec)//产生一个警告说明此数据库不存在
mysql&gt; create database drop_database;
Query OK, 1 row affected (0.00 sec)
mysql&gt; drop database if exists drop_database;//if exists 判断数据库是否存在，不存在也不产生错误
Query OK, 0 rows affected (0.00 sec)
</code></pre><h3 id="4-4-连接数据库"><a href="#4-4-连接数据库" class="headerlink" title="4.4 连接数据库"></a>4.4 连接数据库</h3><p>命令： use &lt;数据库名&gt;</p>
<p>use 语句可以通告MySQL把db_name数据库作为默认（当前）数据库使用，用于后续语句。该数据库保持为默认数据库，直到语段的结尾，或者直到发布一个不同的USE语句：</p>
<pre><code>mysql&gt; USE db1;
mysql&gt; SELECT COUNT(*) FROM mytable;   # selects from db1.mytable
mysql&gt; USE db2;
mysql&gt; SELECT COUNT(*) FROM mytable;   # selects from db2.mytable
</code></pre><p>使用USE语句为一个特定的当前的数据库做标记，不会阻碍您访问其它数据库中的表。下面的例子可以从db1数据库访问作者表，并从db2数据库访问编辑表：</p>
<pre><code>mysql&gt; USE db1;
mysql&gt; SELECT author_name,editor_name FROM author,db2.editor
   -&gt;        WHERE author.editor_id = db2.editor.editor_id;
</code></pre><h3 id="4-5-当前选择的数据库"><a href="#4-5-当前选择的数据库" class="headerlink" title="4.5 当前选择的数据库"></a>4.5 当前选择的数据库</h3><p>命令：mysql&gt; select database();</p>
<h4 id="4-5-1显示MYSQL的版本"><a href="#4-5-1显示MYSQL的版本" class="headerlink" title="4.5.1显示MYSQL的版本"></a>4.5.1显示MYSQL的版本</h4><pre><code>mysql&gt; select version(); 
</code></pre><h4 id="4-5-2-显示当前时间"><a href="#4-5-2-显示当前时间" class="headerlink" title="4.5.2 显示当前时间"></a>4.5.2 显示当前时间</h4><pre><code>mysql&gt; select now(); 
</code></pre><h4 id="4-5-3显示年月日"><a href="#4-5-3显示年月日" class="headerlink" title="4.5.3显示年月日"></a>4.5.3显示年月日</h4><pre><code>SELECT DAYOFMONTH(CURRENT_DATE); 
</code></pre><h4 id="4-5-4显示字符串"><a href="#4-5-4显示字符串" class="headerlink" title="4.5.4显示字符串"></a>4.5.4显示字符串</h4><pre><code>mysql&gt; SELECT &quot;welecome to my blog!&quot;; 
</code></pre><h4 id="4-5-5当计算器用"><a href="#4-5-5当计算器用" class="headerlink" title="4.5.5当计算器用"></a>4.5.5当计算器用</h4><pre><code>select ((4 * 4) / 10 ) + 25; 
</code></pre><h4 id="4-5-6串接字符串"><a href="#4-5-6串接字符串" class="headerlink" title="4.5.6串接字符串"></a>4.5.6串接字符串</h4><pre><code>select CONCAT(f_name, &quot; &quot;, l_name) 
</code></pre><h3 id="4-6创建数据表"><a href="#4-6创建数据表" class="headerlink" title="4.6创建数据表"></a>4.6创建数据表</h3><p>命令：create table &lt;表名&gt; ( &lt;字段名1&gt; &lt;类型1&gt; [,..&lt;字段名n&gt; &lt;类型n&gt;]);</p>
<pre><code>mysql&gt; create table MyClass(
&gt; id int(4) not null primary key auto_increment,
&gt; name char(20) not null,
&gt; sex int(4) not null default &apos;0&apos;,
&gt; degree double(16,2));
</code></pre><h3 id="5-1-删除数据表"><a href="#5-1-删除数据表" class="headerlink" title="5.1 删除数据表"></a>5.1 删除数据表</h3><pre><code>命令：drop table &lt;表名&gt;
</code></pre><p>DROP TABLE用于取消一个或多个表。您必须有每个表的DROP权限。所有的表数据和表定义会被取消，所以使用本语句要小心！</p>
<h3 id="5-2-表插入数据"><a href="#5-2-表插入数据" class="headerlink" title="5.2 表插入数据"></a>5.2 表插入数据</h3><pre><code>命令：insert into &lt;表名&gt; [( &lt;字段名1&gt;[,..&lt;字段名n &gt; ])] values ( 值1 )[, ( 值n )]

mysql&gt; insert into MyClass values(1,&apos;Tom&apos;,96.45),(2,&apos;Joan&apos;,82.99), (2,&apos;Wang&apos;, 96.59);
</code></pre><p>注意：insert into每次只能向表中插入一条记录。</p>
<h3 id="5-3-查询表中的数据"><a href="#5-3-查询表中的数据" class="headerlink" title="5.3 查询表中的数据"></a>5.3 查询表中的数据</h3><pre><code>命令： select &lt;字段1，字段2，...&gt; from &lt; 表名 &gt; where &lt; 表达式 &gt;
#例如：查看表 MyClass 中所有数据
mysql&gt; select * from MyClass;
</code></pre><h3 id="5-4删除表中数据"><a href="#5-4删除表中数据" class="headerlink" title="5.4删除表中数据"></a>5.4删除表中数据</h3><p>命令：delete from 表名 where 表达式</p>
<pre><code>mysql&gt; delete from MyClass where id=1;
</code></pre><h3 id="5-5修改表中数据"><a href="#5-5修改表中数据" class="headerlink" title="5.5修改表中数据"></a>5.5修改表中数据</h3><p>语法：update 表名 set 字段=新值,… where 条件<br>    mysql&gt; update MyClass set name=’Mary’ where id=1;</p>
<p>1.单表的MySQL UPDATE语句：</p>
<pre><code>UPDATE [LOW_PRIORITY] [IGNORE] tbl_name SET col_name1=expr1 [, col_name2=expr2 ...] [WHERE where_definition] [ORDER BY ...] [LIMIT row_count]
</code></pre><p>2.多表的UPDATE语句：</p>
<pre><code>UPDATE [LOW_PRIORITY] [IGNORE] table_references SET col_name1=expr1 [, col_name2=expr2 ...] [WHERE where_definition]
</code></pre><p>UPDATE语法可以用新值更新原有表行中的各列。SET子句指示要修改哪些列和要给予哪些值。WHERE子句指定应更新哪些行。如果没有WHERE子句，则更新所有的行。如果指定了ORDER BY子句，则按照被指定的顺序对行进行更新。LIMIT子句用于给定一个限值，限制可以被更新的行的数目。</p>
<h3 id="5-6增加字段"><a href="#5-6增加字段" class="headerlink" title="5.6增加字段"></a>5.6增加字段</h3><p>命令：alter table 表名 add字段 类型 其他;</p>
<pre><code>mysql&gt; alter table MyClass add passtest int(4) default &apos;0&apos;
</code></pre><h4 id="5-6-1加索引"><a href="#5-6-1加索引" class="headerlink" title="5.6.1加索引"></a>5.6.1加索引</h4><pre><code>mysql&gt; alter table 表名 add index 索引名 (字段名1[，字段名2 …]);
mysql&gt; alter table employee add index emp_name (name);
</code></pre><h4 id="5-6-2加主关键字的索引"><a href="#5-6-2加主关键字的索引" class="headerlink" title="5.6.2加主关键字的索引"></a>5.6.2加主关键字的索引</h4><pre><code>mysql&gt; alter table 表名 add primary key (字段名);
mysql&gt; alter table employee add primary key(id);
</code></pre><h4 id="5-6-3加唯一限制条件的索引"><a href="#5-6-3加唯一限制条件的索引" class="headerlink" title="5.6.3加唯一限制条件的索引"></a>5.6.3加唯一限制条件的索引</h4><pre><code>mysql&gt; alter table 表名 add unique 索引名 (字段名);
mysql&gt; alter table employee add unique emp_name2(cardnumber);
</code></pre><h4 id="5-6-4删除某个索引"><a href="#5-6-4删除某个索引" class="headerlink" title="5.6.4删除某个索引"></a>5.6.4删除某个索引</h4><pre><code>mysql&gt; alter table 表名 drop index 索引名;
mysql&gt;alter table employee drop index emp_name;
</code></pre><h4 id="5-6-5增加字段"><a href="#5-6-5增加字段" class="headerlink" title="5.6.5增加字段"></a>5.6.5增加字段</h4><pre><code>ALTER TABLE table_name ADD field_name field_type;
</code></pre><h4 id="5-6-6修改原字段名称及类型"><a href="#5-6-6修改原字段名称及类型" class="headerlink" title="5.6.6修改原字段名称及类型"></a>5.6.6修改原字段名称及类型</h4><pre><code>ALTER TABLE table_name CHANGE old_field_name new_field_name field_type;
</code></pre><h4 id="5-6-7删除字段"><a href="#5-6-7删除字段" class="headerlink" title="5.6.7删除字段"></a>5.6.7删除字段</h4><pre><code>MySQL ALTER TABLE table_name DROP field_name;
</code></pre><h3 id="5-7修改表名"><a href="#5-7修改表名" class="headerlink" title="5.7修改表名"></a>5.7修改表名</h3><p>命令：rename table 原表名 to 新表名;</p>
<pre><code>mysql&gt; rename table MyClass to YouClass;
</code></pre><p>当你执行 RENAME 时，你不能有任何锁定的表或活动的事务。你同样也必须有对原初表的 ALTER 和 DROP 权限，以及对新表的 CREATE 和 INSERT 权限。<br>如果在多表更名中，MySQL 遭遇到任何错误，它将对所有被更名的表进行倒退更名，将每件事物退回到最初状态。</p>
<h3 id="5-8备份数据库"><a href="#5-8备份数据库" class="headerlink" title="5.8备份数据库"></a>5.8备份数据库</h3><p>命令在DOS的[url=file://\mysql\bin]\mysql\bin[/url]目录下执行</p>
<h4 id="5-8-1导出整个数据库"><a href="#5-8-1导出整个数据库" class="headerlink" title="5.8.1导出整个数据库"></a>5.8.1导出整个数据库</h4><p>导出文件默认是存在mysql\bin目录下</p>
<pre><code>mysqldump -u 用户名 -p 数据库名 &gt; 导出的文件名
mysqldump -u user_name -p123456 database_name &gt; outfile_name.sql
</code></pre><h4 id="5-8-2导出一个表"><a href="#5-8-2导出一个表" class="headerlink" title="5.8.2导出一个表"></a>5.8.2导出一个表</h4><pre><code>mysqldump -u 用户名 -p 数据库名 表名&gt; 导出的文件名
mysqldump -u user_name -p database_name table_name &gt; outfile_name.sql
</code></pre><h4 id="5-8-3导出一个数据库结构"><a href="#5-8-3导出一个数据库结构" class="headerlink" title="5.8.3导出一个数据库结构"></a>5.8.3导出一个数据库结构</h4><pre><code>mysqldump -u user_name -p -d –add-drop-table database_name &gt; outfile_name.sql
-d 没有数据 –add-drop-table 在每个create语句之前增加一个drop table
</code></pre><h4 id="5-8-4带语言参数导出"><a href="#5-8-4带语言参数导出" class="headerlink" title="5.8.4带语言参数导出"></a>5.8.4带语言参数导出</h4><pre><code>mysqldump -uroot -p –default-character-set=latin1 –set-charset=gbk –skip-opt database_name &gt; outfile_name.sql

例如，将aaa库备份到文件back_aaa中：
[root@test1 root]# cd　/home/data/mysql
[root@test1 mysql]# mysqldump -u root -p --opt aaa &gt; back_aaa
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/24/scrapy框架获取的数据pipelines存储方式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="陈亚坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈亚坤的Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/24/scrapy框架获取的数据pipelines存储方式/" itemprop="url">
                  scrapy框架获取的数据pipelines存储方式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-24T22:06:27+08:00">
                2017-07-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>###1.在scrapy框架中存储为Json,Redis,Mongodb,Mysql,CSV文件</p>
<pre><code>import json
import redis
from scrapy.conf import settings
import pymongo

#存储为Json
class AqiJsonPipeline(object):
    #新建一个Json存储文件
    def open_spider(self, spider):
        #指定写入权限
        self.f = open(&quot;aqi.json&quot;, &quot;w&quot;)
    def process_item(self, item, spider):
        item[&quot;spider&quot;] = spider.name
        #转编码格式
        content = json.dumps(dict(item), ensure_ascii = False) + &quot;,\n&quot;
        self.f.write(content.encode(&quot;utf-8&quot;))
        return item

    def close_spider(self, spider):
        self.f.close()

#存储为csv文件
class AqiCSVPipeline(object):
    def open_spider(self, spider):
        # 创建csv文件对象，拥有写权限
        self.csv = open(&quot;aqi.csv&quot;, &quot;w&quot;)
        # 查创建一个Csv文件读写对象，参数是csv文件对象
        self.csvexporter = CsvItemExporter(self.csv)
        # 指定读写权限，可以开始写入数据
        self.csvexporter.start_exporting()

    def process_item(self, item, spider):
        # 将item数据写入到csv文件里
        self.csvexporter.export_item(item)
        return item

    def close_spider(self, spider):
        # 表述数据写入结束
        self.csvexporter.finish_exporting()
        self.csv.close()

#存储到redis数据库中
class AqiRedisPipeline(object):
    def open_spider(self, spider):
        # 创建Redis数据库连接对象
        self.redis_cli = redis.Redis(host = &quot;127.0.0.1&quot;, port = 6379)

    def process_item(self, item, spider):
        # 将item转换成json格式
        content = json.dumps(dict(item), ensure_ascii = False)
        # 将数据写入到list里，key AQI， value content
        self.redis_cli.lpush(&quot;AQI&quot;, content)
        return item

#存储为Mongodb数据库中
class AqiMongoPipeline(object):
    def open_spider(self, spider):
        # 创建MongoDb数据库链接对象
        self.mongo_cli = pymongo.MongoClient(host = &quot;127.0.0.1&quot;, port = 27017)
        # 创建MongoDB的数据库
        self.dbname = self.mongo_cli[&quot;AQI&quot;]
        # 创建数据库的表
        self.sheet = self.dbname[&quot;AQI_data&quot;]

    def process_item(self, item, spider):
        # 将数据插入到表里
        self.sheet.insert(dict(item))
        return item

#存储为mysql数据库中，需要提前创建mysql数据库
#将数据存储到mysql数据库
from twisted.enterprise import adbapi
import MySQLdb
import MySQLdb.cursors
class MySQLStorePipeline(object):
    #数据库参数
    def __init__(self):
        dbargs = dict(
             host = &apos;127.0.0.1&apos;,
             db = &apos;test&apos;,
             user = &apos;root&apos;,
             passwd = &apos;112233&apos;,
             cursorclass = MySQLdb.cursors.DictCursor,
             charset = &apos;utf8&apos;,
             use_unicode = True
            )
        self.dbpool = adbapi.ConnectionPool(&apos;MySQLdb&apos;,**dbargs)

    &apos;&apos;&apos;
    The default pipeline invoke function
    &apos;&apos;&apos;
    def process_item(self, item,spider):
        res = self.dbpool.runInteraction(self.insert_into_table,item)
        return item
    #插入的表，此表需要事先建好
    def insert_into_table(self,conn,item):
            conn.execute(&apos;insert into douban(rank, title, rate,qute,link) values(%s,%s,%s,%s,%s)&apos;, (
                item[&apos;rank&apos;][0],
                item[&apos;title&apos;][0],
                 # item[&apos;star&apos;][0],
                 item[&apos;rate&apos;][0],
                 item[&apos;quote&apos;][0],
                 item[&apos;link&apos;][0])
                )
</code></pre><h3 id="2-改写为Scrapy-Redis后将redis缓存数据库中的内容转存到Mongodb或Mysql中。"><a href="#2-改写为Scrapy-Redis后将redis缓存数据库中的内容转存到Mongodb或Mysql中。" class="headerlink" title="2.改写为Scrapy-Redis后将redis缓存数据库中的内容转存到Mongodb或Mysql中。"></a>2.改写为Scrapy-Redis后将redis缓存数据库中的内容转存到Mongodb或Mysql中。</h3><p><strong>转存到Mongodb中<br>1.启动MongoDB数据库：sudo mongod<br>2.执行下面程序：py2 process_aqi_mongodb.py</strong></p>
<pre><code># process_aqi_mongodb.py

# -*- coding: utf-8 -*-

import json
import redis
import pymongo

def main():

    # 指定Redis数据库信息
    rediscli = redis.Redis(host=&apos;192.168.88.94&apos;, port=6379, db=0)
    # 指定MongoDB数据库信息
    mongocli = pymongo.MongoClient(host=&apos;127.0.0.1&apos;, port=27017)

    # 创建数据库名
    db = mongocli[&apos;aqi&apos;]
    # 创建表名
    sheet = db[&apos;aqi_data&apos;]

    while True:
        # FIFO模式为 blpop，LIFO模式为 brpop，获取键值
        source, data = rediscli.blpop([&quot;aqi:items&quot;])

        item = json.loads(data)
        sheet.insert(item)

        try:
            print u&quot;Processing: %(name)s &lt;%(link)s&gt;&quot; % item
        except KeyError:
            print u&quot;Error procesing: %r&quot; % item

if __name__ == &apos;__main__&apos;:
    main()
</code></pre><p>1.转存到Mysql中<br>2.启动mysql：mysql.server start（更平台不一样）<br>3.登录到root用户：mysql -uroot -p<br>4.创建数据库aqi:create database aqi;<br>5.切换到指定数据库：use aqi<br>6.创建表aqi_data以及所有字段的列名和数据类型。</p>
<pre><code>#process_aqi_mysql.py

# -*- coding: utf-8 -*-

import json
import redis
import MySQLdb

def main():
    # 指定redis数据库信息
    rediscli = redis.StrictRedis(host=&apos;192.168.88.94&apos;, port = 6379, db = 0)
    # 指定mysql数据库
    mysqlcli = MySQLdb.connect(host=&apos;127.0.0.1&apos;, user=&apos;root&apos;, passwd=&apos;xxxxxxx&apos;, db = &apos;aqi&apos;, port=3306, use_unicode=True)

    while True:
        # FIFO模式为 blpop，LIFO模式为 brpop，获取键值
        source, data = rediscli.blpop([&quot;aqi:items&quot;])
        item = json.loads(data)

        try:
            # 使用cursor()方法获取操作游标
            cur = mysqlcli.cursor()
            # 使用execute方法执行SQL INSERT语句
            cur.execute(&quot;INSERT INTO aqi_data (city, date, aqi, level, pm2_5, pm10, so2, co, no2, o3, rank, spider, crawled) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)&quot;, [item[&apos;city&apos;], item[&apos;date&apos;], item[&apos;aqi&apos;], item[&apos;level&apos;], item[&apos;pm2_5&apos;], item[&apos;pm10&apos;], item[&apos;so2&apos;], item[&apos;co&apos;], item[&apos;no2&apos;], item[&apos;o3&apos;], item[&apos;rank&apos;], item[&apos;spider&apos;], item[&apos;crawled&apos;]])
            # 提交sql事务
            mysqlcli.commit()
            #关闭本次操作
            cur.close()
        except MySQLdb.Error,e:
            print &quot;Mysql Error %d: %s&quot; % (e.args[0], e.args[1])

if __name__ == &apos;__main__&apos;:
    main()
</code></pre><h3 id="作者：陈亚坤"><a href="#作者：陈亚坤" class="headerlink" title="作者：陈亚坤"></a><strong>作者：陈亚坤</strong></h3><h3 id="邮箱：cykstart-163-com"><a href="#邮箱：cykstart-163-com" class="headerlink" title="邮箱：cykstart@163.com"></a><strong>邮箱：cykstart@163.com</strong></h3><h3 id="版权声明"><a href="#版权声明" class="headerlink" title="版权声明:"></a><strong>版权声明:</strong></h3><p>本篇博客仅作为参考学习资料，版权所有，侵权必删，请联系！部分代码取自互联网公开资料。版权归其所写个人/公司所有！</p>
<h3 id="参考资料链接"><a href="#参考资料链接" class="headerlink" title="参考资料链接:"></a><strong>参考资料链接:</strong></h3><p><a href="http://blog.csdn.net/qy20115549/article/details/52575291" target="_blank" rel="external">http://blog.csdn.net/qy20115549/article/details/52575291</a><br><a href="http://www.cnblogs.com/yccmelody/p/5416456.html" target="_blank" rel="external">http://www.cnblogs.com/yccmelody/p/5416456.html</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/24/将scary改写为scrapy-redis分布式爬虫基本操作/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="陈亚坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈亚坤的Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/24/将scary改写为scrapy-redis分布式爬虫基本操作/" itemprop="url">
                  将scary改写为scrapy-redis分布式爬虫基本操作
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-24T21:42:44+08:00">
                2017-07-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-修改添加settings-py"><a href="#1-修改添加settings-py" class="headerlink" title="1.修改添加settings.py"></a>1.修改添加settings.py</h3><blockquote>
<p><strong>使用scrapy-redis提供的相关组件,列举了修改后的配置文件中与scrapy-redis有关的部分，middleware、proxy等内容在此就省略</strong></p>
</blockquote>
<pre><code># 1(必须). 使用了scrapy_redis的去重组件，在redis数据库里做去重
DUPEFILTER_CLASS = &quot;scrapy_redis.dupefilter.RFPDupeFilter

# 2(必须). 使用了scrapy_redis的调度器，在redis里分配请求
SCHEDULER = &quot;scrapy_redis.scheduler.Scheduler&quot;

# 3(必须). 在redis中保持scrapy-redis用到的各个队列，从而允许暂停和暂停后恢复，也就是不清理redis queues
SCHEDULER_PERSIST = True

# 4(必须). 通过配置RedisPipeline将item写入key为 spider.name : items 的redis的list中，供后面的分布式处理item
# 这个已经由 scrapy-redis 实现，不需要我们写代码，直接使用即可
ITEM_PIPELINES = {
    # &apos;AQI.pipelines.AqiJsonPipeline&apos;: 200,
    # &apos;AQI.pipelines.AqiCSVPipeline&apos;: 300,
    # &apos;AQI.pipelines.AqiRedisPipeline&apos;: 400,
    # &apos;AQI.pipelines.AqiMongoPipeline&apos;: 500,
    &apos;scrapy_redis.pipelines.RedisPipeline&apos;: 100
}

# 5(必须). 指定redis数据库的连接参数
REDIS_HOST = &apos;127.0.0.1&apos;
REDIS_PORT = 6379

# 6.如果不启用则按scrapy默认的策略
#  -1. 默认的 按优先级排序(Scrapy默认)，由sorted set实现的一种非FIFO、LIFO方式。
# SCHEDULER_QUEUE_CLASS = &apos;scrapy_redis.queue.SpiderPriorityQueue&apos;
#  -2. 可选的 按先进先出排序（FIFO）
# SCHEDULER_QUEUE_CLASS = &apos;scrapy_redis.queue.SpiderQueue&apos;
#  -3. 可选的 按后进先出排序（LIFO）
# SCHEDULER_QUEUE_CLASS = &apos;scrapy_redis.queue.SpiderStack&apos;

# 7. LOG等级
#LOG_LEVEL = &apos;DEBUG&apos;
</code></pre><h3 id="2-修改-spiders"><a href="#2-修改-spiders" class="headerlink" title="2.修改 spiders"></a>2.修改 spiders</h3><pre><code># 1. 导入RedisSpider类，不使用Spider
from scrapy_redis.spiders import RedisSpider

# 2. 修改父类 RedisSpider
class AqiSpider(RedisSpider):

# 3. 取消start_urls，增加redis-key，接受从Redis数据库里的指令    
#start_urls = [baseURL]
redis_key = &apos;aqi:start_urls&apos;
</code></pre><h3 id="3-分布式爬虫执行方式："><a href="#3-分布式爬虫执行方式：" class="headerlink" title="3.分布式爬虫执行方式："></a>3.分布式爬虫执行方式：</h3><pre><code>#1.在Master端启动redis-server：
sudo redis-server /etc/redis/redis.conf

#2. 在Slave端spiders目录下分别启动爬虫，不分先后：
scrapy runspider aqi.py
#有时继续使用scrapy crawl aqi.py

#3. 所有Slaver端将处于等待指令状态，在Master端的redis-cli里push一个redis_key

redis-cli&gt; lpush aqi:start_urls https://www.aqistudy.cn/historydata/
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/17/selenium-python-linux环境搭建/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="陈亚坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈亚坤的Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/17/selenium-python-linux环境搭建/" itemprop="url">
                  selenium+python+linux环境搭建
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-17T15:44:52+08:00">
                2017-07-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a><strong>常见问题</strong></h2><h3 id="1-创建webdriver，以chrom在linux环境中举例"><a href="#1-创建webdriver，以chrom在linux环境中举例" class="headerlink" title="1.创建webdriver，以chrom在linux环境中举例"></a>1.创建webdriver，以chrom在linux环境中举例</h3><blockquote>
<p>1.下载chromedriver驱动程序，解压到/user/bin路径下</p>
</blockquote>
<pre><code>mv chromedriver_linux64.zip /usr/bin
unzip chromedriver_linux64.zip
</code></pre><blockquote>
<p>2.改变chromdriver的执行权限</p>
</blockquote>
<pre><code>chmod a+x chromedriver
</code></pre><blockquote>
<p>3.测试代码</p>
</blockquote>
<pre><code>from selenium import webdriver
#在其他系统中也可以在括号内添加webdriver路径
#driver=webdriver.Chrome(&quot;/Users/lucyxu/Downloads/chromedriver&quot;)
driver=webdriver.Chrome()
driver.get(&quot;http://www.baidu.com&quot;)
</code></pre><h3 id="作者：陈亚坤"><a href="#作者：陈亚坤" class="headerlink" title="作者：陈亚坤"></a><strong>作者：陈亚坤</strong></h3><h3 id="邮箱：cykstart-163-com"><a href="#邮箱：cykstart-163-com" class="headerlink" title="邮箱：cykstart@163.com"></a><strong>邮箱：cykstart@163.com</strong></h3><h3 id="版权声明"><a href="#版权声明" class="headerlink" title="版权声明:"></a><strong>版权声明:</strong></h3><p>本篇博客仅作为参考学习资料，版权所有，侵权必删，请联系！部分代码取自互联网公开资料。版权归其所写个人/公司所有！</p>
<h3 id="参考资料链接"><a href="#参考资料链接" class="headerlink" title="参考资料链接:"></a><strong>参考资料链接:</strong></h3><p><a href="http://download.csdn.net/detail/xh3608683/9447439" target="_blank" rel="external">http://download.csdn.net/detail/xh3608683/9447439</a><br><a href="http://www.cnblogs.com/technologylife/p/5829944.html" target="_blank" rel="external">http://www.cnblogs.com/technologylife/p/5829944.html</a><br><a href="https://testerhome.com/topics/6521" target="_blank" rel="external">https://testerhome.com/topics/6521</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/17/Phantomjs设置问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="陈亚坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈亚坤的Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/17/Phantomjs设置问题/" itemprop="url">
                  Phantomjs设置问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-17T14:45:33+08:00">
                2017-07-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="phantomJS的配置问题"><a href="#phantomJS的配置问题" class="headerlink" title="phantomJS的配置问题"></a>phantomJS的配置问题</h2><h3 id="1-phantomJS浏览器的配置，比如user-agent伪装、代理、超时返回等选项。"><a href="#1-phantomJS浏览器的配置，比如user-agent伪装、代理、超时返回等选项。" class="headerlink" title="1.phantomJS浏览器的配置，比如user-agent伪装、代理、超时返回等选项。"></a>1.phantomJS浏览器的配置，比如user-agent伪装、代理、超时返回等选项。</h3><pre><code>from selenium import webdriver
# 引入配置对象DesiredCapabilities
from selenium.webdriver.common.desired_capabilities import DesiredCapabilities
dcap = dict(DesiredCapabilities.PHANTOMJS)
#从USER_AGENTS列表中随机选一个浏览器头，伪装浏览器
dcap[&quot;phantomjs.page.settings.userAgent&quot;] = (random.choice(USER_AGENTS))
# 不载入图片，爬页面速度会快很多
dcap[&quot;phantomjs.page.settings.loadImages&quot;] = False
# 设置代理
service_args = [&apos;--proxy=127.0.0.1:9999&apos;,&apos;--proxy-type=socks5&apos;]
#打开带配置信息的phantomJS浏览器
driver = webdriver.PhantomJS(phantomjs_driver_path, desired_capabilities=dcap,service_args=service_args)                
# 隐式等待5秒，可以自己调节
driver.implicitly_wait(5)
# 设置10秒页面超时返回，类似于requests.get()的timeout选项，driver.get()没有timeout选项
# 以前遇到过driver.get(url)一直不返回，但也不报错的问题，这时程序会卡住，设置超时选项能解决这个问题。
driver.set_page_load_timeout(10)
# 设置10秒脚本超时时间
driver.set_script_timeout(10)
</code></pre><h3 id="2-phantomjs使用代理将会极大的拖累访问速度，一般使用scrapy框架中间件配置代理和User-Agent等。但如果使用Phantomjs则不在支持多线程并发。"><a href="#2-phantomjs使用代理将会极大的拖累访问速度，一般使用scrapy框架中间件配置代理和User-Agent等。但如果使用Phantomjs则不在支持多线程并发。" class="headerlink" title="2. phantomjs使用代理将会极大的拖累访问速度，一般使用scrapy框架中间件配置代理和User-Agent等。但如果使用Phantomjs则不在支持多线程并发。"></a>2. phantomjs使用代理将会极大的拖累访问速度，一般使用scrapy框架中间件配置代理和User-Agent等。但如果使用Phantomjs则不在支持多线程并发。</h3><blockquote>
<p>示例代码如下</p>
</blockquote>
<pre><code>#coding=utf-8

from selenium import webdriver
from selenium.webdriver.common.desired_capabilities import DesiredCapabilities
from scrapy.http import HtmlResponse
from scrapy.conf import settings
import time
import random
import base64

class ChoiceAgent(object):
    &quot;&quot;&quot;随机更换user-agent&quot;&quot;&quot;
    def process_request(self, request, spider):
        agent = random.choice(settings[&apos;USER_AGENTS&apos;])
        request.headers.setdefault(&apos;User-Agent&apos;,agent)
        print &apos;向请求添加User-Agent&apos;


class SeleniumMiddleware(object):
    def process_request(self, request, spider):
        &quot;&quot;&quot; selenium 处理没有数据的代码&quot;&quot;&quot;
        if request.meta.has_key(&apos;selenium&apos;):

            agent = random.choice(settings[&apos;USER_AGENTS&apos;])
            dcap = dict(DesiredCapabilities.PHANTOMJS)
            dcap[&quot;phantomjs.page.settings.userAgent&quot;] = (agent)
            driver = webdriver.PhantomJS(desired_capabilities=dcap, service_args=[&apos;--load-images=false&apos;])

            print request.url
            # driver = webdriver.PhantomJS() 
            driver.get(request.url)
            # driver.get(&quot;http://www.baidu.com/&quot;)
            # print driver.page_source
            time.sleep(2)
            body = driver.page_source
            url = driver.current_url
            driver.quit()
            # with open(&apos;test.html&apos;,&apos;w&apos;) as f:
            #     f.write(body.encode(&apos;utf-8&apos;))            
            return HtmlResponse(url, body=body, encoding=&apos;utf-8&apos;, request=request)

class RandomProxy(object):
    &quot;&quot;&quot; 使用代理 &quot;&quot;&quot;
    def __init__(self):
        self.proxy_auth = &quot;lai_323:ey65dwtm&quot;
        self.proxy = &apos;122.114.136.239:16816&apos;
    def process_request(self, request, spider):
        # freeProxy = random.choice(proxy)
        # freeproxy = freeProxy.keys()[0] + &apos;:&apos; + freeProxy.values()[0]
        # print &apos;向请求添加代理&apos;
        # request.meta[&apos;proxy&apos;] = &apos;http://&apos; + freeproxy

        base64_userpass = base64.b64encode(self.proxy_auth)
        #print proxy
        request.meta[&apos;proxy&apos;] = &quot;http://&quot; + self.proxy
        #if self.proxy_auth != None:
        request.headers[&apos;Proxy-Authorization&apos;] = &quot;Basic &quot; + base64_userpass
</code></pre><h3 id="作者：陈亚坤"><a href="#作者：陈亚坤" class="headerlink" title="作者：陈亚坤"></a><strong>作者：陈亚坤</strong></h3><h3 id="邮箱：cykstart-163-com"><a href="#邮箱：cykstart-163-com" class="headerlink" title="邮箱：cykstart@163.com"></a><strong>邮箱：cykstart@163.com</strong></h3><h3 id="版权声明"><a href="#版权声明" class="headerlink" title="版权声明:"></a><strong>版权声明:</strong></h3><p>本篇博客仅作为参考学习资料，版权所有，侵权必删，请联系！部分代码取自互联网公开资料。版权归其所写个人/公司所有！</p>
<h3 id="参考资料链接"><a href="#参考资料链接" class="headerlink" title="参考资料链接:"></a><strong>参考资料链接:</strong></h3><p><a href="http://www.jianshu.com/p/9d408e21dc3a" target="_blank" rel="external">http://www.jianshu.com/p/9d408e21dc3a</a><br><a href="http://blog.csdn.net/tcorpion/article/details/70213435" target="_blank" rel="external">http://blog.csdn.net/tcorpion/article/details/70213435</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/17/pytesseract机器识别常见问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="陈亚坤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈亚坤的Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/17/pytesseract机器识别常见问题/" itemprop="url">
                  pytesseract机器识别常见问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-17T12:41:43+08:00">
                2017-07-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-OSError-Errno-2-No-such-file-or-directory"><a href="#1-OSError-Errno-2-No-such-file-or-directory" class="headerlink" title="1.OSError: [Errno 2] No such file or directory"></a>1.OSError: [Errno 2] No such file or directory</h3><blockquote>
<p><strong>原因：没有安装tesseract-ocr包</strong>  </p>
<p><strong>解决方案：sudo apt-get install tesseract-ocr</strong></p>
</blockquote>
<h3 id="作者：陈亚坤"><a href="#作者：陈亚坤" class="headerlink" title="作者：陈亚坤"></a><strong>作者：陈亚坤</strong></h3><h3 id="邮箱：cykstart-163-com"><a href="#邮箱：cykstart-163-com" class="headerlink" title="邮箱：cykstart@163.com"></a><strong>邮箱：cykstart@163.com</strong></h3><h3 id="版权声明"><a href="#版权声明" class="headerlink" title="版权声明:"></a><strong>版权声明:</strong></h3><p>本篇博客仅作为参考学习资料，版权所有，侵权必删，请联系！部分代码取自互联网公开资料。版权归其所写个人/公司所有！</p>
<h3 id="参考资料链接"><a href="#参考资料链接" class="headerlink" title="参考资料链接:"></a><strong>参考资料链接:</strong></h3><p><a href="http://blog.csdn.net/kezhen/article/details/42967789" target="_blank" rel="external">http://blog.csdn.net/kezhen/article/details/42967789</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="陈亚坤" />
          <p class="site-author-name" itemprop="name">陈亚坤</p>
           
              <p class="site-description motion-element" itemprop="description">python web</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">articles</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">15</span>
                <span class="site-state-item-name">tags</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">陈亚坤</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Thème -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  





  

  

  

  

</body>
</html>
